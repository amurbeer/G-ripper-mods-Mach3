' skip if simulation generate patch If IsLoading() ThenExit SubEnd If' --- main code ---Dim ProbeDepth : ProbeDepth = GetVar(501)    ' MAX down (mm)Dim StartHeight : StartHeight = GetVar(500)   ' Home start  Z (mm)Dim FeedRate : FeedRate = GetVar(502)        ' Speed mm/minDim FileName : FileName = "c:\Mach3\Probe_Scan_Data\ProbeData.txt" ' patch' --- read current coordinats X, Y ---Dim XPos, YPosXPos = GetOEMDRO(800)  ' Read current XYPos = GetOEMDRO(801)  ' Read current Y' --- Go to start Height Z ---Code "G0 Z" & StartHeightWhile IsMoving()    Sleep(10)Wend' --- Probe Touch ---Code "G31 Z" & ProbeDepth & " F" & FeedRateWhile IsMoving()    Sleep(10)Wend' --- Read end coordinats Z ---Dim ZPos'ZPos = GetVar(2002) ' Read Z coordinates touchZPos = GetDro(2) ' Read Z coordinates touch' --- Record data to file ---Dim FSO, FileSet FSO = CreateObject("Scripting.FileSystemObject")Set File = FSO.OpenTextFile(FileName, 8, True) ' Open file to record (add lines)File.WriteLine XPos & "," & YPos & "," & ZPosFile.Close' --- Go to start Z Height ---Code "G0 Z" & StartHeightWhile IsMoving()    Sleep(10)Wend   